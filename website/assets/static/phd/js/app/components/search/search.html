<h3>Filter PhD Applications</h3>

<form role="form" ng-submit="vm.search()">

    <div class="form-group">
        <label class="control-label" for="registryRef">Registry Ref Number</label>
        <input type="text" class="form-control" id="registryRef" ng-model="vm.searchOptions.registryRef" placeholder="E.g. 07362354">
    </div>

    <div class="form-group">
        <label for="surname">Surname</label>
        <input type="text" class="form-control" id="surname" ng-model="vm.searchOptions.surname" placeholder="E.g. Szeles">
    </div>
    <div class="form-group">
        <label for="forename">Forename</label>
        <input type="text" class="form-control" id="forename" ng-model="vm.searchOptions.forename" placeholder="E.g. Marton">
    </div>


    <div class="form-group checkbox-group">
        <div>Possible Funding</div>
        <div ng-repeat="(key, value) in vm.searchFieldOptions['possible_funding']" class="checkbox-inline">
            <label class="checkbox" for="{{ key }}">
                <input type="checkbox" ng-model="vm.checkBoxSelection['possible_funding'][key]" name="group" id="{{ key }}" />
                {{ value }}
            </label>
        </div>
    </div>

    <div class="form-group checkbox-group">
        <div>Funding Status</div>
        <div ng-repeat="(key, value) in vm.searchFieldOptions['funding_status']" class="checkbox-inline">
            <label class="checkbox" for="{{ key }}">
                <input type="checkbox" ng-model="vm.checkBoxSelection['funding_status'][key]" name="group" id="{{ key }}" />
                {{ value }}
            </label>
        </div>
    </div>

    <div class="form-group checkbox-group">
        <div>Origin (Fee Classification)</div>
        <div ng-repeat="(key, value) in vm.searchFieldOptions['origin']" class="checkbox-inline">
            <label class="checkbox" for="{{ key }}">
                <input type="checkbox" ng-model="vm.checkBoxSelection['origin'][key]" name="group" id="{{ key }}" />
                {{ value }}
            </label>
        </div>
    </div>

    <div class="form-group checkbox-group">
        <div>Student Type</div>
        <div ng-repeat="(key, value) in vm.searchFieldOptions['student_type']" class="checkbox-inline">
            <label class="checkbox" for="{{ key }}">
                <input type="checkbox" ng-model="vm.checkBoxSelection['student_type'][key]" name="group" id="{{ key }}" />
                {{ value }}
            </label>
        </div>
    </div>


    <div class="form-group">
        <button class="btn btn-primary btn-lg btn-block" type="submit">Search</button>
    </div>

</form>

<h3>Search Results</h3>

<!-- Field Selection for display and download -->
<div>
    <div class="form-group checkbox-group">
        <div>Export search results</div>
        <div ng-repeat="(key, value) in vm.applicationFieldSelection" class="checkbox-inline">
            <label class="checkbox" for="{{ key }}">
                <input type="checkbox" ng-model="vm.applicationFieldSelection[key]" />
                {{ key }}
            </label>
        </div>
    </div>
    <button class="btn btn-primary btn-sm" type="button" ng-show="vm.searchResults.length !== 0" ng-click="vm.downloadZip()">Download Zip</button>
</div>

<div class="table-responsive">

    <table class="table table-striped table-bordered table-condensed table-hover search-table" ts-wrapper>
        <thead>
            <tr>
                <th></th>
                <th ts-criteria="registry_ref|parseInt">Registry Ref</th>
                <th ts-criteria="created_at|parseInt" ts-default>Created At</th>
                <th ts-criteria="surname|lowercase">Name</th>
                <th ts-criteria="research_subject|lowercase">Research Subject</th>
                <th ts-criteria="possible_funding|lowercase">Funding</th>
                <th ts-criteria="origin|lowercase">Origin</th>
            </tr>
        </thead>

        <tbody>
            <tr ng-repeat="data in vm.searchResults track by data.id" ts-repeat class="{{ data.selected ? 'selected' : '' }}">
                <td>
                    <input type="checkbox" ng-checked="data.selected" ng-click="vm.selectRow(data)" />
                </td>
                <td>
                    <b>{{ data.registry_ref }}</b>
                </td>
                <td align="center">
                   {{ data.created_at | date : 'yyyy-MM-dd' }}
                </td>
                <td>
                    <a href="application/edit/{{ data.id }}/{{ data.registry_ref }}">
                        <b>{{ data.surname }} ({{ data.forename }})</b>
                    </a>
                </td>
                <td>
                    {{ data.research_subject }}
                </td>
                <td>
                    {{ data.possible_funding }}
                </td>
                <td>
                    {{ data.origin }}
                </td>
            </tr>
        </tbody>

    </table>

</div>
